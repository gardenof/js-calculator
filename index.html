<div class="calculator">
  <div class="display">0</div>
  <div class="buttons">
    <button class="operator" data-action="+">+</button>
    <button class="operator" data-action="-">-</button>
    <button class="operator" data-action="*">x</button>
    <button class="operator" data-action="/">รท</button>
    <button class="number" >7</button>
    <button class="number" >8</button>
    <button class="number" >9</button>
    <button class="number" >4</button>
    <button class="number" >5</button>
    <button class="number" >6</button>
    <button class="number" >1</button>
    <button class="number" >2</button>
    <button class="number" >3</button>
    <button class="number" >0</button>
    <button class="decimal" data-action="decimal">.</button>
    <button class="clear"   data-action="clear">AC</button>
    <button class="equal"   data-action="=">=</button>
  </div>
</div>

<script>
  buttonsDiv  = document.querySelector('.buttons')
  displayDiv  = document.querySelector('.display')
  numberOne   = ''
  oppOne      = ''
  numberTwo   = ''
  oppTwo      = ''
  numberThree = ''
  oppThree    = ''
  totalMath   = ''

  document.addEventListener("keydown", keyEvent => {
    keyEventActions(keyEvent)
  })

  buttonsDiv.addEventListener('click', clickEvent => {
    clickEventActions(clickEvent)
  })

  function keyEventActions(keyEvent) {
    displayValue = displayDiv.textContent
    if(keyEvent.key === "*" || keyEvent.key === "+"||
       keyEvent.key === "-" || keyEvent.key === "/"){
      saveInput(displayValue, keyEvent.key)
    }else if (keyEvent.key === "."){
      addDecimal()
    }else if((!keyEvent.shiftKey) &&
             (keyEvent.which >=48 && keyEvent.which <=57) ||
             (keyEvent.which >=96 && keyEvent.which <=105)){
      updatingNumberDisplay(keyEvent.key)
    }else if (keyEvent.which == 13){
        //THIS IS THE ENTER/RETURN KEY
    }else if (keyEvent.which === 46 || keyEvent.which === 8||
              keyEvent.which === 27 ){
      allClear()
    }else if (keyEvent.which === 187){
      saveInput(displayValue, keyEvent.key)
    }
  }

  function clickEventActions(clickEvent){
    displayValue = displayDiv.textContent
    button = clickEvent.target

    if (button.matches('button')){
      dataAction = button.dataset.action
      switch(dataAction){
        case "+":
        case "-":
        case "*":
        case "/":
        case "=":
          saveInput(displayValue, dataAction)
          break;
        case "decimal":
          addDecimal()
          break;
        case "clear":
          allClear()
          break;
        default:
          updatingNumberDisplay(button.textContent)
      }
    }
  }

  function updatingNumberDisplay(newNumber){
    if( displayValue === '0' ||
          displayDiv.classList.value === 'display totalMath'){
          displayDiv.textContent = newNumber
          displayDiv.classList.remove("totalMath")
    } else{
          displayDiv.textContent = (displayValue + newNumber)
    }
  }

  function addDecimal(){
    if(displayDiv.classList.value === 'display totalMath' ){
      displayDiv.textContent = "0."
      displayDiv.classList.remove("totalMath")
    }else if(!displayValue.includes(".")){
      displayDiv.textContent = (displayValue + ".")
    }
  }

  function allClear(){
    equalsClear()
    displayDiv.textContent = "0"
  }

  function equalsClear(){
    numberOne  = ''
    oppOne     = ''
    numberTwo  = ''
    oppTwo     = ''
    numberThree= ''
    oppThree   = ''
  }

  function saveInput(num,opp){
    if(!numberOne && opp === "=" ) {
      return
    }else if(!oppOne){
      numberOne = num
      oppOne = opp
    }else if (!oppTwo){
      numberTwo = num
      oppTwo = opp
    }else if (!oppThree){
      numberThree = num
      oppThree = opp
    }
    displayDiv.classList.add("totalMath")
    doMathOrderOpps()
  }

  function doMathOrderOpps(){
    op1type = oppGroup(oppOne)
    op2type = oppGroup(oppTwo)
    op3type = oppGroup(oppThree)
    if ( oppOne === '' || oppTwo === ''){
    } else if (op1type === op2type ||
              (op1type === "A" && op2type === "B") ||
               op2type === "c"){
      newNumberdoMath = twoNumberMath(numberOne, oppOne, numberTwo)
      numberOne = newNumberdoMath
      oppOne    = oppTwo
      numberTwo = ''
      oppTwo = ''
      displayDiv.textContent = numberOne
    } else if (op2type === op3type){
      newNumberdoMath = twoNumberMath(numberTwo, oppTwo, numberThree)
      numberTwo = newNumberdoMath
      oppTwo    = oppThree
      numberThree = ''
      oppThree = ''
      displayDiv.textContent = numberTwo
    } else if ((op2type === "A" && op3type === "B") ||
               op3type === "c"){
      newNumberdoMath = twoNumberMath(numberTwo, oppTwo, numberThree)
      newNumberdoMath2 = twoNumberMath(numberOne, oppOne, newNumberdoMath)
      numberOne = newNumberdoMath2
      oppOne    = oppThree
      numberTwo = ''
      oppTwo = ''
      numberThree =''
      oppThree = ''
    }

    if (op2type === "c" || op3type === "c"){
      if (numberOne.toString().length > 10){
        displayDiv.textContent = "Error"
      }else{
        displayDiv.textContent = numberOne
      }
      equalsClear()
      displayDiv.classList.add("totalMath")
    }
  }

  function twoNumberMath(n1, o1, n2){
    switch(o1){
        case "+":
            return Number(n1) + Number(n2)
        break;
        case "-":
            return Number(n1) - Number(n2)
        break;
        case "*":
            return Number(n1) * Number(n2)
        break;
        case "/":
            return Number(n1) / Number(n2)
        break;
    }
  }

  function oppGroup(opp){
    switch(opp){
        case "=":
          return "c"
        break;
        case "+":
        case "-":
          return "B"
        break;
        case "*":
        case "/":
          return "A"
        break;
    }
  }

  function pa(textMessage){
    if(textMessage){
      console.log(textMessage)
    }
    console.log("numberOne   = " + numberOne)
    console.log("oppOne      = " + oppOne)
    console.log("numberTwo   = " + numberTwo)
    console.log("oppTwo      = " + oppTwo)
    console.log("numberThree = " + numberThree)
    console.log("oppThree    = " + oppThree)
    console.log("totalMath   = " + totalMath)
    console.log("display     = " + displayDiv.textContent)
  }
</script>
<style>
.calculator {
  border-radius: 5px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 400px;
}
.display {
  font-size: 5rem;
  height: 80px;
  background-color: #252525;
  color: #fff;
  text-align: right;
  padding-right: 20px;
}
button {
  height: 60px;
  border-radius: 3px;
  background-color: transparent;
  font-size: 2rem;
  color: #333;
}
.buttons {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
}
.equal {
  height: 100%;
  grid-area: 2 / 4 / 6 / 5;
}
</style>
